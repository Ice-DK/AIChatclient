# ===========================================
# FRONTEND - React SPA
# ===========================================
frontend:
  applicationName: ai-chatclient-frontend

  deployment:
    enabled: true
    replicas: 2
    image:
      repository: registry.netic.dk/cloudfactory/ai-chatclient-frontend
      tag: "3.0.0"
    ports:
      - containerPort: 80
        name: http
    resources:
      limits:
        memory: 128Mi
      requests:
        cpu: 50m
        memory: 64Mi
    livenessProbe:
      httpGet:
        path: /health
        port: http
      initialDelaySeconds: 10
      periodSeconds: 30
      timeoutSeconds: 3
    readinessProbe:
      httpGet:
        path: /health
        port: http
      initialDelaySeconds: 5
      periodSeconds: 10
      timeoutSeconds: 3

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 10
    metrics:
      - type: Resource
        resource:
          name: cpu
          target:
            type: Utilization
            averageUtilization: 70
      - type: Resource
        resource:
          name: memory
          target:
            type: Utilization
            averageUtilization: 80

  service:
    enabled: true
    ports:
      - port: 80
        name: http
        protocol: TCP
        targetPort: http

  httpProxy:
    enabled: true
    host: chat.cloudfactory.dk
    tls:
      secretName: ai-chatclient-frontend-tls

# ===========================================
# BACKEND - Hono API
# ===========================================
backend:
  applicationName: ai-chatclient-backend

  deployment:
    enabled: true
    replicas: 2
    image:
      repository: registry.netic.dk/cloudfactory/ai-chatclient-backend
      tag: "3.0.0"
    ports:
      - containerPort: 3000
        name: http
    resources:
      limits:
        memory: 512Mi
      requests:
        cpu: 100m
        memory: 256Mi
    livenessProbe:
      httpGet:
        path: /health
        port: http
      initialDelaySeconds: 10
      periodSeconds: 30
      timeoutSeconds: 3
    readinessProbe:
      httpGet:
        path: /health
        port: http
      initialDelaySeconds: 5
      periodSeconds: 10
      timeoutSeconds: 3
    env:
      - name: PORT
        value: "3000"
      - name: NODE_ENV
        value: "production"
      - name: FRONTEND_URL
        value: "https://chat.cloudfactory.dk"
      - name: BACKEND_URL
        value: "https://chat-api.cloudfactory.dk"
    envFrom:
      - secretRef:
          name: ai-chatclient-backend-secrets

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 10
    metrics:
      - type: Resource
        resource:
          name: cpu
          target:
            type: Utilization
            averageUtilization: 70

  service:
    enabled: true
    ports:
      - port: 3000
        name: http
        protocol: TCP
        targetPort: http

  httpProxy:
    enabled: true
    host: chat-api.cloudfactory.dk
    tls:
      secretName: ai-chatclient-backend-tls
